<header
  class="fixed top-0 inset-x-0 h-16 z-30 flex items-center backdrop-blur bg-[rgba(4,27,24,0.40)] border-b border-white/50 text-white">
  <div class="relative w-full px-4 flex items-center justify-between">
    <!-- Brand -->
    <a [routerLink]="['/']" class="flex items-center gap-2 font-bold">
      <span class="w-2.5 h-2.5 rounded-full bg-accent shadow-[0_0_10px_theme(colors.accent)]"></span>
      Travelika
    </a>

    <!-- Nav -->
    <nav class="hidden md:flex items-center gap-6 text-sm opacity-90 absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2">
      <a [routerLink]="['/']" fragment="destinasi" class="hover:opacity-100">Forests</a>
      <a [routerLink]="['/']" fragment="cara" class="hover:opacity-100">How It Works</a>
      <a [routerLink]="['/']" fragment="keunggulan" class="hover:opacity-100">Benefits</a>


    </nav>

    <!-- Area auth -->
    <ng-container *ngIf="!ses; else userMenu">
      <!-- href fallback untuk non-SPA; click diarahkan via Router -->
      <a href="/login" (click)="goLogin($event)" id="loginLink">Sign In / Register</a>
    </ng-container>

    <!-- User menu -->
    <ng-template #userMenu>
      <div class="relative">
        <button (click)="toggleMenu($event)"
          class="flex items-center gap-2 px-2 py-1 rounded-full bg-white/10 hover:bg-white/20">
          <span class="w-7 h-7 rounded-full bg-accent text-blend grid place-items-center text-xs font-extrabold">
            {{ initials(ses?.name || ses?.email) }}
          </span>
          <span class="hidden sm:inline max-w-[10rem] truncate">{{ ses?.name || ses?.email }}</span>
          <svg class="opacity-80" width="16" height="16" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path d="M5.25 7.5L10 12.25L14.75 7.5H5.25Z"></path>
          </svg>
        </button>

        <div
          class="absolute right-0 mt-2 w-52 rounded-xl bg-white text-slate-700 shadow-lg border border-slate-200 overflow-hidden"
          [class.hidden]="!dropdownOpen" (click)="$event.stopPropagation()">
          <a [routerLink]="['/']" class="block px-3 py-2 hover:bg-slate-50">Beranda</a>
          <a [routerLink]="['/']" fragment="pesan" class="block px-3 py-2 hover:bg-slate-50">Pesan Pass</a>
          <a href="/mybookings" (click)="goBookHistory($event)"
            class="block px-3 py-2 hover:bg-slate-50 flex items-center justify-between">
            <span>Book History</span>
          </a>
          <button (click)="openResetConfirm($event)"
            class="w-full text-left px-3 py-2 hover:bg-slate-50 text-amber-700">Reset Data</button>
          <button (click)="logout()" class="w-full text-left px-3 py-2 hover:bg-slate-50 text-red-600">Keluar</button>
        </div>
      </div>
    </ng-template>
  </div>
</header>
<!-- Reset Data Confirm Modal -->
<div *ngIf="resetOpen" class="fixed inset-0 z-50" aria-modal="true" role="dialog">
  <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" (click)="closeResetConfirm()"></div>
  <div
    class="relative mx-auto max-w-md w-[calc(100%-2rem)] mt-24 bg-white rounded-2xl p-6 shadow-xl border border-slate-200">
    <div class="flex items-start justify-between gap-4">
      <div>
        <h3 class="text-lg font-bold text-slate-900">Reset Transaction Data</h3>
        <p class="text-slate-600 text-sm mt-1">This removes all bookings and payment records saved in this browser.</p>
      </div>
      <button class="text-slate-400 hover:text-slate-600" aria-label="Close" (click)="closeResetConfirm()">✕</button>
    </div>
    <div class="mt-4 text-sm text-slate-700">
      Affected stores: <span class="font-mono">bookings</span>, <span class="font-mono">payments</span>.
    </div>
    <div class="mt-5 flex justify-end gap-2">
      <button class="px-4 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50"
        (click)="closeResetConfirm()" [disabled]="resetLoading">Cancel</button>
      <button
        class="px-4 py-2 rounded-lg bg-amber-600 text-white font-bold hover:brightness-110 disabled:opacity-60 disabled:cursor-not-allowed"
        (click)="confirmReset()" [disabled]="resetLoading">
        {{ resetLoading ? 'Resetting…' : 'Yes, Reset' }}
      </button>
    </div>
  </div>
</div>
