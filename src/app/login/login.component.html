<section class="relative min-h-screen text-white text-center mt-10" data-page style="background-image:url('./section1.jpg'); background-size:cover; background-position:center;">
  <div class="absolute inset-0 bg-gradient-to-b from-transparent via-[rgba(4,27,24,0.65)] to-blend"></div>

  <div class="relative w-full">
    <app-header></app-header>

    <div class="w-full px-4 pt-28 pb-14 flex justify-center" data-auto-reveal>
      <div class="mx-auto max-w-md bg-white/10 border border-white/30 rounded-2xl shadow-brand backdrop-blur p-6 md:p-7 text-left flex flex-col">

        <div class="mb-3">
          <div class="flex items-center justify-between gap-3 mb-2">
            <h1 class="text-xl md:text-2xl font-semibold">Welcome to Travelika</h1>
            <a href="/" class="text-xs md:text-sm text-white/90 hover:text-white underline underline-offset-4">Back to Home</a>
          </div>
          <p class="text-white/90 text-xs md:text-sm">Sign in to save bookings and purchase your <b>Travelika Pass</b>. Your account is stored securely in this browser (IndexedDB).</p>
        </div>

        <div class="grid grid-cols-2 rounded-xl overflow-hidden border border-white/30 bg-white/10 mb-4 shrink-0">
          <button class="py-2 text-sm font-semibold" [class.bg-accent]="tab() === 'login'" [class.text-blend]="tab() === 'login'" (click)="switchTab('login')">Sign In</button>
          <button class="py-2 text-sm font-semibold" [class.bg-accent]="tab() === 'register'" [class.text-blend]="tab() === 'register'" (click)="switchTab('register')">Register</button>
        </div>

        <ng-container *ngIf="errorMsg || infoMsg">
          <div class="mb-3 shrink-0">
            <div *ngIf="errorMsg" class="px-3 py-2 rounded-lg bg-red-500/15 border border-red-400/40 text-red-100 text-xs mb-2">{{ errorMsg }}</div>
            <div *ngIf="infoMsg" class="px-3 py-2 rounded-lg bg-amber-500/15 border border-amber-400/40 text-amber-100 text-xs">{{ infoMsg }}</div>
          </div>
        </ng-container>

        <div class="flex-1">
          <form *ngIf="tab() === 'login'" (ngSubmit)="onLogin()" class="grid gap-2">
            <label class="text-xs opacity-90">Email</label>
            <input [(ngModel)]="loginEmail" name="loginEmail" type="email" required autocomplete="email" class="w-full rounded-lg px-3 py-2.5 bg-black/30 border border-white/40 text-teal-50 placeholder-teal-200/60 focus:outline-none focus:ring-2 focus:ring-accent" placeholder="you@example.com" />
            <label class="text-xs opacity-90">Password</label>
            <input [(ngModel)]="loginPass" name="loginPass" type="password" required autocomplete="current-password" class="w-full rounded-lg px-3 py-2.5 bg-black/30 border border-white/40 text-teal-50 placeholder-teal-200/60 focus:outline-none focus:ring-2 focus:ring-accent" placeholder="••••••••" />
            <button type="submit" [disabled]="loading" class="mt-2 px-4 py-2.5 rounded-lg font-bold text-sm bg-accent text-blend hover:brightness-110 disabled:opacity-70">{{ loading ? 'Signing in…' : 'Sign In' }}</button>
          </form>

          <form *ngIf="tab() === 'register'" (ngSubmit)="onRegister()" class="grid gap-2">
            <label class="text-xs opacity-90">Full Name</label>
            <input [(ngModel)]="regName" name="regName" type="text" required autocomplete="name" class="w-full rounded-lg px-3 py-2.5 bg-black/30 border border-white/40 text-teal-50 placeholder-teal-200/60 focus:outline-none focus:ring-2 focus:ring-accent" placeholder="Your name" />
            <label class="text-xs opacity-90">Email</label>
            <input [(ngModel)]="regEmail" name="regEmail" type="email" required autocomplete="email" class="w-full rounded-lg px-3 py-2.5 bg-black/30 border border-white/40 text-teal-50 placeholder-teal-200/60 focus:outline-none focus:ring-2 focus:ring-accent" placeholder="you@example.com" />
            <label class="text-xs opacity-90">Password</label>
            <input [(ngModel)]="regPass" name="regPass" type="password" required minlength="6" autocomplete="new-password" class="w-full rounded-lg px-3 py-2.5 bg-black/30 border border-white/40 text-teal-50 placeholder-teal-200/60 focus:outline-none focus:ring-2 focus:ring-accent" placeholder="At least 6 characters" />
            <button type="submit" [disabled]="loading" class="mt-2 px-4 py-2.5 rounded-lg font-bold text-sm bg-accent text-blend hover:brightness-110 disabled:opacity-70">{{ loading ? 'Creating…' : 'Create Account' }}</button>
          </form>
        </div>

        <p class="text-[11px] text-white/80 mt-3 leading-snug shrink-0">By continuing, you agree that your account is stored in this browser’s IndexedDB. You can sign out anytime from the header menu.</p>
      </div>
    </div>
  </div>
</section>

<!-- Floating reset-all button (bottom-right) -->
<button (click)="openResetAll()" class="fixed bottom-4 right-4 z-40 px-3 py-2 rounded-full text-[11px] md:text-xs bg-white/10 border border-white/30 text-white backdrop-blur hover:bg-white/20" aria-label="Reset all local data">Reset All Data <span class="hidden md:inline">(accounts, bookings, payments)</span></button>

<!-- Reset All Confirm Modal -->
<div *ngIf="resetOpen" class="fixed inset-0 z-50" aria-modal="true" role="dialog">
  <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" (click)="closeResetAll()"></div>
  <div class="relative mx-auto max-w-md w-[calc(100%-2rem)] mt-24 bg-white rounded-2xl p-6 shadow-xl border border-slate-200">
    <div class="flex items-start justify-between gap-4">
      <div>
        <h3 class="text-lg font-bold text-slate-900">Reset All Local Data</h3>
        <p class="text-slate-600 text-sm mt-1">This clears <b>accounts</b>, <b>bookings</b>, and <b>payments</b> stored in this browser. You will be signed out.</p>
      </div>
      <button class="text-slate-400 hover:text-slate-600" aria-label="Close" (click)="closeResetAll()">✕</button>
    </div>
    <div class="mt-5 flex justify-end gap-2">
      <button class="px-4 py-2 rounded-lg border border-slate-200 text-slate-700 hover:bg-slate-50" (click)="closeResetAll()" [disabled]="resetLoading">Cancel</button>
      <button class="px-4 py-2 rounded-lg bg-red-600 text-white font-bold hover:brightness-110 disabled:opacity-60 disabled:cursor-not-allowed" (click)="confirmResetAll()" [disabled]="resetLoading">{{ resetLoading ? 'Resetting…' : 'Yes, Reset All' }}</button>
    </div>
  </div>
</div>
